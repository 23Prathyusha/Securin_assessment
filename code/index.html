<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Recipe Explorer</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    body {
      background-color: #f8f9fa;
      padding-top: 20px;
    }
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(0,0,0,.3);
      border-radius: 50%;
      border-top-color: #000;
      animation: spin 1s ease-in-out infinite;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    .filter-section {
      background: white;
      padding: 15px;
      border-radius: 5px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    .truncate {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 200px;
    }
    .star-rating {
      color: #ffc107;
    }
    .pagination {
      margin-bottom: 0;
    }
    .form-select-sm {
      width: auto;
      display: inline-block;
    }
    .offcanvas {
      width: 450px !important;
    }
    @media (max-width: 768px) {
      .offcanvas {
        width: 100% !important;
      }
    }
  </style>
</head>
<body>
  <div class="container py-3">
    <h2 class="mb-4 text-center">Recipe Explorer <i class="fas fa-utensils"></i></h2>
    
    <!-- Filter Section -->
    <div class="filter-section mb-4">
      <div class="row g-3">
        <div class="col-md-3">
          <label class="form-label">Title</label>
          <input id="titleFilter" class="form-control" placeholder="Search by title">
        </div>
        <div class="col-md-2">
          <label class="form-label">Cuisine</label>
          <select id="cuisineFilter" class="form-select">
            <option value="">All Cuisines</option>
          </select>
        </div>
        <div class="col-md-2">
          <label class="form-label">Min Rating</label>
          <select id="ratingFilter" class="form-select">
            <option value="">Any</option>
            <option value="3">3+ Stars</option>
            <option value="4">4+ Stars</option>
            <option value="4.5">4.5+ Stars</option>
          </select>
        </div>
        <div class="col-md-2">
          <label class="form-label">Max Calories</label>
          <input type="number" id="caloriesFilter" class="form-control" placeholder="Max calories">
        </div>
        <div class="col-md-3">
          <label class="form-label">Sort By</label>
          <select id="sortBy" class="form-select">
            <option value="">Default</option>
            <option value="title">Title (A-Z)</option>
            <option value="-title">Title (Z-A)</option>
            <option value="rating">Rating (Low-High)</option>
            <option value="-rating">Rating (High-Low)</option>
            <option value="total_time">Time (Short-Long)</option>
            <option value="-total_time">Time (Long-Short)</option>
            <option value="calories">Calories (Low-High)</option>
            <option value="-calories">Calories (High-Low)</option>
          </select>
        </div>
      </div>
      <div class="row mt-3">
        <div class="col-12">
          <button id="searchBtn" class="btn btn-primary">
            <span id="searchText">Search</span>
            <span id="searchSpinner" class="loading d-none"></span>
          </button>
          <button id="resetBtn" class="btn btn-outline-secondary ms-2">Reset</button>
        </div>
      </div>
    </div>

    <!-- Results Section -->
    <div class="table-responsive">
      <table class="table table-bordered table-hover">
        <thead class="table-dark">
          <tr>
            <th>Title</th>
            <th>Cuisine</th>
            <th>Rating</th>
            <th>Total Time (mins)</th>
            <th>Serves</th>
          </tr>
        </thead>
        <tbody id="recipeTable">
          <tr>
            <td colspan="5" class="text-center">Loading recipes...</td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Pagination and Results Count -->
    <div class="d-flex justify-content-between align-items-center mt-3">
        <div class="d-flex align-items-center">
            <span class="me-2">Show</span>
            <select id="perPageSelect" class="form-select form-select-sm">
                <option value="15">15</option>
                <option value="25">25</option>
                <option value="50">50</option>
            </select>
            <span class="ms-2" id="resultsCount"></span>
        </div>
        <ul class="pagination mb-0" id="pagination"></ul>
    </div>

    <!-- Fallback Message -->
    <div id="fallback" class="alert alert-info d-none mt-3">No recipes found matching your criteria.</div>
  </div>

  <!-- Recipe Detail Drawer -->
  <div class="offcanvas offcanvas-end" tabindex="-1" id="recipeDrawer">
    <div class="offcanvas-header bg-light">
      <h5 class="offcanvas-title" id="drawerTitle"></h5>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
    </div>
    <div class="offcanvas-body">
      <div id="drawerLoading" class="text-center py-5">
        <div class="loading"></div>
        <p>Loading recipe details...</p>
      </div>
      <div id="drawerContent" class="d-none">
        <p><strong>Description:</strong> <span id="drawerDesc"></span></p>
        <p class="mb-1"><strong>Total Time:</strong> <span id="drawerTime"></span> <a href="#" id="expandTime" class="text-decoration-none">(show details)</a></p>
        <div id="timeDetails" class="ms-3 mb-3 d-none">
          <p class="mb-1"><small>Prep Time: <span id="prepTime"></span> mins</small></p>
          <p class="mb-1"><small>Cook Time: <span id="cookTime"></span> mins</small></p>
        </div>
        
        <h6 class="mt-4 border-top pt-3">Nutrition Information</h6>
        <div class="table-responsive">
          <table class="table table-sm">
            <tbody id="drawerNutrition"></tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="script.js"></script>
</body>
</html>